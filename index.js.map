{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nconst API_KEY = \"50632256-d176889c05d2eb53a5e69ee7e\";\nconst BASE_URL = \"https://pixabay.com/api/\";\n\nexport async function getImagesByQuery(query, page = 1) {\n    try {\n        const response = await axios.get(BASE_URL, {\n            params: {\n                key: API_KEY,\n                q: query,\n                image_type: \"photo\",\n                orientation: \"horizontal\",\n                safesearch: true,\n                per_page: 15,\n                page: page\n            }\n        });\n\n    return response.data;\n    } catch (error) {\n        return { hits: [], totalHits: 0 };\n    }\n}\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst gallery = document.querySelector(\".gallery\");\nlet lightbox = new SimpleLightbox(\".gallery a\", {\n    captionsData: 'alt', captionDelay: 250\n});\n\n\nexport function createGallery(images) {\n    try {\n        const markup = images.map(({ webformatURL, largeImageURL, tags, likes, comments, views, downloads }) => {\n            const processedTags = tags.split(',').map(tag => tag.trim()).slice(0, 5).join(', ');\n\n            return `\n            <li class=\"gallery-item\">\n                <a href=\"${largeImageURL}\" class=\"gallery-item\">\n                    <div class=\"img-container\">\n                        <img src=\"${webformatURL}\" alt=\"${processedTags}\" />\n                        <ul class=\"overlay\">\n                            <li class=\"stats\">Likes ${likes}</li>\n                            <li class=\"stats\">Views ${views}</li>\n                            <li class=\"stats\">Comments ${comments}</li>\n                            <li class=\"stats\">Downloads ${downloads}</li>\n                        </ul>\n                    </div>\n                </a>\n            </li>`;\n        }).join(\"\");\n\n        gallery.innerHTML = markup;\n        lightbox.refresh();\n    } catch (error) {\n        iziToast.error({\n            title: \"Error\",\n            message: \"Помилка при створенні галереї!\",\n            position: 'topRight'\n        });\n    }\n}\n\nexport function appendGallery(images) {\n    const markup = images\n        .map(({ webformatURL, largeImageURL, tags, likes, comments, views, downloads }) => {\n        const processedTags = tags\n            .split(\",\")\n            .map((tag) => tag.trim())\n            .slice(0, 5)\n            .join(\", \");\n        return `<li class=\"gallery-item\">\n                    <a href=\"${largeImageURL}\" class=\"gallery-item\">\n                    <div class=\"img-container\">\n                        <img src=\"${webformatURL}\" alt=\"${processedTags}\" />\n                        <ul class=\"overlay\">\n                            <li class=\"stats\">Likes ${likes}</li>\n                            <li class=\"stats\">Views ${views}</li>\n                            <li class=\"stats\">Comments ${comments}</li>\n                            <li class=\"stats\">Downloads ${downloads}</li>\n                        </ul>\n                    </div>\n                    </a>\n                </li>`;\n        })\n        .join(\"\");\n    gallery.insertAdjacentHTML(\"beforeend\", markup);\n    lightbox.refresh();\n}\n\nexport function clearGallery() {\n    gallery.innerHTML = \"\";\n}\n\nexport function showLoader() {\n    document.querySelector(\".loader\").classList.add(\"visible\");\n}\nexport function hideLoader() {\n    document.querySelector(\".loader\").classList.remove(\"visible\");\n}\nexport function showMoreButton() {\n    document.querySelector(\".more-btn\").classList.add(\"visible\");\n}\nexport function hideMoreButton() {\n    document.querySelector(\".more-btn\").classList.remove(\"visible\");\n}\nexport function showMoreText() {\n    document.querySelector(\".more-text\").classList.add(\"visible\");\n}\nexport function hideMoreText() {\n    document.querySelector(\".more-text\").classList.remove(\"visible\");\n}\n\n","import { getImagesByQuery } from \"./js/pixabay-api.js\";\nimport { createGallery, appendGallery, clearGallery, showLoader, hideLoader, showMoreButton, hideMoreButton, showMoreText, hideMoreText } from \"./js/render-functions.js\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nconst form = document.querySelector(\".form\");\nconst input = document.querySelector(\"input[name='search-text']\");\nconst loadMoreBtn = document.querySelector(\".more-btn\");\n\nlet currentPage = 1;\nlet currentQuery = \"\";\nlet totalDisplayed = 0;\nlet availableImages = 0;\n\nform.addEventListener(\"submit\", async event => {\n    event.preventDefault();\n\n    currentQuery = input.value.trim();\n\n    if (!currentQuery) {\n        iziToast.error({\n            title: \"Error\",\n            message: \"Search query cannot be empty!\",\n            position: \"topRight\",\n        });\n        return;\n    }\n\n    currentPage = 1;\n    totalDisplayed = 0;\n    clearGallery();\n    hideMoreButton();\n    showLoader();\n\n    try {\n        const data = await getImagesByQuery(currentQuery, currentPage);\n        hideLoader();\n\n        if (data.hits.length === 0) {\n            iziToast.warning({\n                title: \"No results\",\n                message: \"Sorry, no images match your search query. Try again!\",\n                position: \"topRight\",\n            });\n            return;\n        }\n\n        availableImages = Math.min(data.totalHits, 500);\n        createGallery(data.hits);\n        totalDisplayed += data.hits.length\n\n        if (totalDisplayed >= availableImages) {\n            iziToast.info({\n                title: \"End of results\",\n                message: \"No more images found.\",\n                position: \"topRight\",\n            });\n            hideMoreButton();\n        } else {\n            showMoreButton();\n        }\n    } catch (error) {\n        hideLoader();\n        iziToast.error({\n            title: \"Error\",\n            message: \"Something went wrong. Please try again later!\",\n            position: \"topRight\",\n        });\n    }\n});\n\nloadMoreBtn.addEventListener(\"click\", async () => {\n    currentPage++;\n    hideMoreButton();\n    showMoreText();\n    \n    try {\n        const data = await getImagesByQuery(currentQuery, currentPage);\n        hideMoreText();\n\n        if (data.hits.length === 0) {\n            iziToast.info({\n                title: \"End of results\",\n                message: \"No more images found.\",\n                position: \"topRight\",\n            });\n            hideMoreButton();\n            return;\n        }\n\n        appendGallery(data.hits);\n        totalDisplayed += data.hits.length;\n        const firstCard = document.querySelector(\".gallery\").firstElementChild;\n        if (firstCard) {\n            const { height: cardHeight } = firstCard.getBoundingClientRect();\n            window.scrollBy({\n                top: cardHeight * 2,\n                behavior: \"smooth\"\n            });\n        }\n\n        if (totalDisplayed >= availableImages) {\n            iziToast.info({\n                title: \"End of results\",\n                message: \"No more images found.\",\n                position: \"topRight\",\n            });\n            hideMoreButton();\n        } else {\n            showMoreButton();\n        }\n    } catch (error) {\n        hideMoreText();\n        iziToast.error({\n            title: \"Error\",\n            message: \"Something went wrong. Please try again later!\",\n            position: \"topRight\",\n        });\n    }\n});\n\n"],"names":["API_KEY","BASE_URL","getImagesByQuery","query","page","axios","gallery","lightbox","SimpleLightbox","createGallery","images","markup","webformatURL","largeImageURL","tags","likes","comments","views","downloads","processedTags","tag","appendGallery","clearGallery","showLoader","hideLoader","showMoreButton","hideMoreButton","showMoreText","hideMoreText","form","input","loadMoreBtn","currentPage","currentQuery","totalDisplayed","availableImages","event","iziToast","data","firstCard","cardHeight"],"mappings":"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"}